{% extends 'app/base.html' %}
{% load static %}
{% load listing_card %}

{% block body_block %}
<div class="container mt-4">
    <div class="row mb-4 align-items-center">
        <div class="col">
            <h2>Search Results for "{{ query }}"</h2>
        </div>
        <div class="col-md-auto">
            <form id="sortForm" method="GET" class="d-flex align-items-center">
                <label for="sort_by" class="me-2 text-nowrap">Sort by:</label>
                <select id="sort_by" name="sort_by" class="form-select" style="min-width: 200px;" onchange="document.getElementById('sortForm').submit();">
                    <option value="title" {% if sort_by == 'title' %}selected{% endif %}>Name (A-Z)</option>
                    <option value="price_low" {% if sort_by == 'price_low' %}selected{% endif %}>Price (Low to High)</option>
                    <option value="price_high" {% if sort_by == 'price_high' %}selected{% endif %}>Price (High to Low)</option>
                    <option value="end_datetime" {% if sort_by == 'end_datetime' %}selected{% endif %}>Ending Soon</option>
                </select>
            </form>
        </div>
    </div>
    
    {% if results %}
        <div class="row g-4">
            {% for listing in results %}
                <div class="col col-12 col-md-6 col-lg-4">
                    {% render_listing listing %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">No results found.</p>
    {% endif %}
</div>

{% endblock %}